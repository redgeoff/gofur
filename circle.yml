# Doesn't actually work!
# node:
#  version: 7.10.0

machine:
  environment:
    NODE_VERSION: 8.1.4

dependencies:
  pre:
    - nvm install $NODE_VERSION
    - nvm use $NODE_VERSION && npm install -g npm

    # Install latest version of Chrome
    - wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | sudo apt-key add -
    - echo 'deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main' | sudo tee /etc/apt/sources.list.d/google-chrome.list
    - sudo apt-get update
    - sudo apt-get install -y google-chrome-stable

  override:
    - nvm use $NODE_VERSION && npm install

test:
  pre:
    - nvm use $NODE_VERSION && npm run assert-beautified
    - nvm use $NODE_VERSION && npm run jshint

  override:
    - nvm use $NODE_VERSION && npm run node-full-test
    - nvm use $NODE_VERSION && npm run browser-test
    - nvm use $NODE_VERSION && npm run browser-coverage-full-test
